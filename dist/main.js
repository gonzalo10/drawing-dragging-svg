!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=2)}([function(t,e){(function(){function t(t,e,i){this.el=t,t.remember("_paintHandler",this);var n=this,r=this.getPlugin();for(var o in this.parent=t.parent(SVG.Nested)||t.parent(SVG.Doc),this.p=this.parent.node.createSVGPoint(),this.m=null,this.startPoint=null,this.lastUpdateCall=null,this.options={},this.el.draw.defaults)this.options[o]=this.el.draw.defaults[o],void 0!==i[o]&&(this.options[o]=i[o]);for(var o in r.point&&(r.pointPlugin=r.point,delete r.point),r)this[o]=r[o];e||this.parent.on("click.draw",(function(t){n.start(t)}))}t.prototype.transformPoint=function(t,e){return this.p.x=t-(this.offset.x-window.pageXOffset),this.p.y=e-(this.offset.y-window.pageYOffset),this.p.matrixTransform(this.m)},t.prototype.start=function(t){var e=this;this.m=this.el.node.getScreenCTM().inverse(),this.offset={x:window.pageXOffset,y:window.pageYOffset},this.options.snapToGrid*=Math.sqrt(this.m.a*this.m.a+this.m.b*this.m.b),this.startPoint=this.snapToGrid(this.transformPoint(t.clientX,t.clientY)),this.init&&this.init(t),this.el.fire("drawstart",{event:t,p:this.p,m:this.m}),SVG.on(window,"mousemove.draw",(function(t){e.update(t)})),this.start=this.point},t.prototype.point=function(t){return this.point!=this.start?this.start(t):this.pointPlugin?this.pointPlugin(t):void this.stop(t)},t.prototype.stop=function(t){t&&this.update(t),this.clean&&this.clean(),SVG.off(window,"mousemove.draw"),this.parent.off("click.draw"),this.el.forget("_paintHandler"),this.el.draw=function(){},this.el.fire("drawstop")},t.prototype.update=function(t){!t&&this.lastUpdateCall&&(t=this.lastUpdateCall),this.lastUpdateCall=t,this.calc(t),this.el.fire("drawupdate",{event:t,p:this.p,m:this.m})},t.prototype.done=function(){this.calc(),this.stop(),this.el.fire("drawdone")},t.prototype.cancel=function(){this.stop(),this.el.remove(),this.el.fire("drawcancel")},t.prototype.snapToGrid=function(t){var e=null;if(t.length)return e=[t[0]%this.options.snapToGrid,t[1]%this.options.snapToGrid],t[0]-=e[0]<this.options.snapToGrid/2?e[0]:e[0]-this.options.snapToGrid,t[1]-=e[1]<this.options.snapToGrid/2?e[1]:e[1]-this.options.snapToGrid,t;for(var i in t)e=t[i]%this.options.snapToGrid,t[i]-=(e<this.options.snapToGrid/2?e:e-this.options.snapToGrid)+(0>e?this.options.snapToGrid:0);return t},t.prototype.param=function(t,e){this.options[t]=null===e?this.el.draw.defaults[t]:e,this.update()},t.prototype.getPlugin=function(){return this.el.draw.plugins[this.el.type]},SVG.extend(SVG.Element,{draw:function(e,i,n){e instanceof Event||"string"==typeof e||(i=e,e=null);var r=this.remember("_paintHandler")||new t(this,e,i||{});return e instanceof Event&&r.start(e),r[e]&&r[e](i,n),this}}),SVG.Element.prototype.draw.defaults={snapToGrid:1},SVG.Element.prototype.draw.extend=function(t,e){var i={};for(var n in"string"==typeof t?i[t]=e:i=t,i){var r=n.trim().split(/\s+/);for(var o in r)SVG.Element.prototype.draw.plugins[r[o]]=i[n]}},SVG.Element.prototype.draw.plugins={},SVG.Element.prototype.draw.extend("rect image",{init:function(t){var e=this.startPoint;this.el.attr({x:e.x,y:e.y,height:0,width:0})},calc:function(t){var e={x:this.startPoint.x,y:this.startPoint.y},i=this.transformPoint(t.clientX,t.clientY);e.width=i.x-e.x,e.height=i.y-e.y,this.snapToGrid(e),e.width<0&&(e.x=e.x+e.width,e.width=-e.width),e.height<0&&(e.y=e.y+e.height,e.height=-e.height),this.el.attr(e)}}),SVG.Element.prototype.draw.extend("line polyline polygon",{init:function(t){this.set=new SVG.Set;var e=this.startPoint,i=[[e.x,e.y],[e.x,e.y]];this.el.plot(i),this.drawCircles()},calc:function(t){var e=this.el.array().valueOf();if(e.pop(),t){var i=this.transformPoint(t.clientX,t.clientY);e.push(this.snapToGrid([i.x,i.y]))}this.el.plot(e)},point:function(t){if(this.el.type.indexOf("poly")>-1){var e=this.transformPoint(t.clientX,t.clientY),i=this.el.array().valueOf();return i.push(this.snapToGrid([e.x,e.y])),this.el.plot(i),this.drawCircles(),void this.el.fire("drawpoint",{event:t,p:{x:e.x,y:e.y},m:this.m})}this.stop(t)},clean:function(){this.set.each((function(){this.remove()})),this.set.clear(),delete this.set},drawCircles:function(){var t=this.el.array().valueOf();this.set.each((function(){this.remove()})),this.set.clear();for(var e=0;e<t.length;++e){this.p.x=t[e][0],this.p.y=t[e][1];var i=this.p.matrixTransform(this.parent.node.getScreenCTM().inverse().multiply(this.el.node.getScreenCTM()));this.set.add(this.parent.circle(5).stroke({width:1}).fill("#ccc").center(i.x,i.y))}}}),SVG.Element.prototype.draw.extend("circle",{init:function(t){var e=this.startPoint;this.el.attr({cx:e.x,cy:e.y,r:1})},calc:function(t){var e=this.transformPoint(t.clientX,t.clientY),i={cx:this.startPoint.x,cy:this.startPoint.y,r:Math.sqrt((e.x-this.startPoint.x)*(e.x-this.startPoint.x)+(e.y-this.startPoint.y)*(e.y-this.startPoint.y))};this.snapToGrid(i),this.el.attr(i)}}),SVG.Element.prototype.draw.extend("ellipse",{init:function(t){var e=this.startPoint;this.el.attr({cx:e.x,cy:e.y,rx:1,ry:1})},calc:function(t){var e=this.transformPoint(t.clientX,t.clientY),i={cx:this.startPoint.x,cy:this.startPoint.y,rx:Math.abs(e.x-this.startPoint.x),ry:Math.abs(e.y-this.startPoint.y)};this.snapToGrid(i),this.el.attr(i)}})}).call(this),SVG.Element.prototype.draw.extend("line polyline polygon",{init:function(t){this.set=new SVG.Set;var e=this.startPoint,i=[[e.x,e.y],[e.x,e.y]];this.el.plot(i)},calc:function(t){var e=this.el.array().valueOf();if(e.pop(),t){var i=this.transformPoint(t.clientX,t.clientY);e.push(this.snapToGrid([i.x,i.y]))}this.el.plot(e)},point:function(t){if(this.el.type.indexOf("poly")>-1){var e=this.transformPoint(t.clientX,t.clientY),i=this.el.array().valueOf();return i.push(this.snapToGrid([e.x,e.y])),this.el.plot(i),void this.el.fire("drawpoint",{event:t,p:{x:e.x,y:e.y},m:this.m})}this.stop(t)},clean:function(){this.set.each((function(){this.remove()})),this.set.clear(),delete this.set}})},function(t,e){const i=document.querySelector("#enablePainting"),n=document.getElementById("drawing");console.log(n);const r=SVG("drawing"),o=r.defs();r.node.setAttribute("onload","makeDraggable(evt)");const s=[];let a,l=0,p=!1;(t=>{var e=document.createElementNS("http://www.w3.org/2000/svg","marker");e.setAttribute("id","arrow"),e.setAttribute("viewBox","0 0 10 10"),e.setAttribute("refX","5"),e.setAttribute("refY","5"),e.setAttribute("markerUnits","strokeWidth"),e.setAttribute("markerWidth","6"),e.setAttribute("markerHeight","6"),e.setAttribute("orient","auto-start-reverse"),e.setAttribute("fill","blue");var i=document.createElementNS("http;//www.w3.org/2000/svg","path");i.setAttribute("d","M 0 0 L 10 5 L 0 10 z"),e.appendChild(i),t.node.appendChild(e)})(o),i.onclick=()=>{console.log("enablePaintingButton");let t="white";p=!p,p&&(t="blue"),i.style.backgroundColor=t};const d=()=>{a=document.getElementById("shape").value;const t={stroke:document.getElementById("colorPanelValue").value,"stroke-width":2,"fill-opacity":0};switch(a){case"mouse paint":return r.polyline().attr(t);case"ellipse":return r.ellipse().attr(t);case"rect":return r.rect().attr(t);case"line":return r.line().attr(t);case"dark_square":return r.rect().attr(t)}return null};r.on("mousedown",t=>{if(!p)return null;const e=d();e.node.setAttribute("class","draggable"),s[l]=e,e.draw(t)}),r.on("mousemove",t=>{if(!p)return null;"mouse paint"===a&&s[l]&&s[l].draw("point",t)}),r.on("mouseup",t=>{if(!p)return null;if("mouse paint"===a)s[l].draw("stop",t);else if("line"===a)s[l].node.setAttribute("marker-end","url(#arrow)"),s[l].draw(t);else if("dark_square"===a){const e=s[l].node.getAttribute("stroke");s[l].node.setAttribute("fill",e),s[l].node.removeAttribute("fill-opacity"),s[l].draw(t)}else s[l].draw(t);l++})},function(t,e,i){"use strict";i.r(e);const n={border:"1px solid #ccc",position:"absolute",width:"100%",height:"100%"};let r="rgb(90, 233, 142)";const o=(t,e)=>{Object.keys(t).forEach(i=>{e.style[i]=t[i]})};function s(t,e,i,n){var r=document.createElement("button");i&&(r.onclick=i),e&&r.setAttribute("id",e),n&&o(n,r);const s=document.createTextNode(t);return r.appendChild(s),r}function a(t,e){var i=document.createElement("div");return t&&i.setAttribute("id",t),o(e,i),i}const l={"mouse paint":"Mouse paint",rect:"Rectangle",ellipse:"Circle",line:"Line",dark_square:"dark square"};function p(){var t=document.getElementsByTagName("BODY")[0];const e=s("Paint","enablePainting"),i=s("Comment","btn-comment"),p=s("Delete","btn-delete"),h=a("drawing",n),u=(f="shape",m=l,(y=document.createElement("select")).setAttribute("id",f),Object.keys(m).forEach(t=>{var e=document.createElement("option");e.setAttribute("value",t),e.innerText=m[t],y.appendChild(e)}),y);var f,m,y;!function(){var t=document.getElementsByTagName("BODY")[0];const e=a("colorPickerPanel",d),i=c("rgb(90, 233, 142)"),n=c("rgb(247, 224, 0)"),s=c("rgb(247, 0, 0)"),l=c("rgb(57, 201, 255)"),p=c("rgb(0, 0, 0)"),h=(u=document.createElement("input"),u.id="colorPanelValue",u.type="text",u.value=r,o({display:"none"},u),u);var u;e.appendChild(i),e.appendChild(l),e.appendChild(s),e.appendChild(n),e.appendChild(p),e.appendChild(h),t.appendChild(e)}(),t.appendChild(e),t.appendChild(h),t.appendChild(u),t.appendChild(i),t.appendChild(p)}const d={justifyContent:" center",boxShadow:"0 0 3px rgba(10,10,10,.2)",width:"260px",top:"55px",left:"calc(50% - 130px)",display:"flex",flexWrap:"wrap",backgroundColor:"#fff",borderRadius:"5px",border:"1px solid #ccc",zIndex:"2",overflow:"hidden",maxHeight:"80vh",overflowY:"auto"},h={position:"relative",cursor:"pointer",width:"50px",height:"50px",display:"flex",alignItems:"center"},c=t=>{var e=document.createElement("label");o(h,e);var i=document.createElement("span");return o((t=>({backgroundColor:t,width:"40px",height:"40px",borderRadius:"30%"}))(t),i),e.appendChild(i),e.id=t,e.addEventListener("click",(function(t){const e=document.getElementById(r).childNodes[0];console.log(e),e.style.border="2px solid transparent",r=t.currentTarget.id,document.getElementById("colorPanelValue").value=r,t.target.style.border="2px solid blue"})),e};var u=function(){p(),function(){const t="\n    .draggable {\n        cursor: move;\n    }\n    ";var e=document.createElement("style");e.type="text/css",e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t)),document.getElementsByTagName("head")[0].appendChild(e)}()};i(0),i(1);u()}]);